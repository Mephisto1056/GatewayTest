# 🎭 角色切换测试说明

## 🚀 快速测试步骤

### 1. 启动系统
```bash
# 方式一：使用一键脚本
./start-test.sh

# 方式二：手动启动
cd backend && npm run start:dev &
cd frontend && npm run dev
```

### 2. 访问问卷页面
打开浏览器访问：`http://localhost:5173`

## 🎯 角色切换测试

### 测试场景一：高层领导者
1. **设置信息**：
   - 姓名：张总
   - 角色：高层领导者
   - 关系：自评（默认选中）

2. **预期结果**：
   - 自主导向问题：23题
   - 高层专属问题：40题
   - 开放式问题：3题
   - 总计：66题

3. **360度权重**：上级50% + 平级30% + 下级20%

### 测试场景二：中层管理者
1. **切换角色**：
   - 在角色下拉框选择"中层管理者"
   - 观察问卷自动重新加载
   - 之前的回答被清空

2. **预期结果**：
   - 自主导向问题：23题
   - 中层专属问题：36题
   - 开放式问题：3题
   - 总计：62题

3. **360度权重**：上级40% + 平级40% + 下级20%

### 测试场景三：基层管理者
1. **切换角色**：
   - 选择"基层管理者"
   - 验证问卷内容变化

2. **预期结果**：
   - 自主导向问题：23题
   - 基层专属问题：33题
   - 开放式问题：3题
   - 总计：59题

3. **360度权重**：上级30% + 平级30% + 下级40%

## 🔍 验证要点

### 界面验证
- ✅ 角色切换时问卷立即更新
- ✅ 题目数量符合预期
- ✅ 之前的回答被清空
- ✅ 进度条重置为0%
- ✅ 姓名可以自由编辑

### 功能验证
- ✅ 所有题目都是必填项
- ✅ 未完成时显示剩余题目数
- ✅ 评分选项只显示文字描述
- ✅ 开放式问题支持文本输入

### API验证
```bash
# 测试不同角色的问卷获取
curl "http://localhost:3000/questionnaires/by-role/高层领导者"
curl "http://localhost:3000/questionnaires/by-role/中层管理者"
curl "http://localhost:3000/questionnaires/by-role/基层管理者"
```

## 📊 测试数据对比

| 角色 | 自主导向 | 角色专属 | 开放式 | 总题数 | 上级权重 | 平级权重 | 下级权重 |
|------|----------|----------|--------|--------|----------|----------|----------|
| 高层领导者 | 23 | 40 | 3 | 66 | 50% | 30% | 20% |
| 中层管理者 | 23 | 36 | 3 | 62 | 40% | 40% | 20% |
| 基层管理者 | 23 | 33 | 3 | 59 | 30% | 30% | 40% |

## 🎮 交互测试

### 完整流程测试
1. **选择高层领导者** → 填写前5题 → **切换到中层** → 确认回答被清空
2. **填写中层问卷** → 完成所有题目 → 提交 → 查看结果
3. **重新开始** → 选择基层管理者 → 测试不同的评分组合

### 边界情况测试
- 快速连续切换角色
- 填写一半时切换角色
- 修改姓名后切换角色
- 不同关系选择的组合测试

## 🐛 常见问题

### Q: 切换角色后为什么回答被清空？
A: 这是设计行为，因为不同角色的问卷内容不同，避免数据混乱。

### Q: 如何保存某个角色的测试进度？
A: 目前需要完整填写并提交，或者在开发者工具中查看localStorage。

### Q: 角色切换时网络请求失败怎么办？
A: 检查后端服务是否正常运行，确认API接口可访问。

## 🎉 测试完成检查清单

- [ ] 三种角色都能正常切换
- [ ] 题目数量符合预期
- [ ] 界面响应流畅
- [ ] 表单验证正常工作
- [ ] 可以成功提交问卷
- [ ] 结果页面正常显示
- [ ] API接口返回正确数据

测试愉快！🚀