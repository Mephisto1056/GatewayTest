# ğŸ”§ æ•…éšœæ’é™¤æŒ‡å—

## ğŸš¨ å¸¸è§é—®é¢˜åŠè§£å†³æ–¹æ¡ˆ

### é—®é¢˜0ï¼šDocker å¯åŠ¨æŠ¥é”™ "permission denied"

#### ç—‡çŠ¶ï¼š
æ‰§è¡Œ `docker-compose up` æ—¶å‡ºç°ç±»ä¼¼ä»¥ä¸‹é”™è¯¯ï¼š
```
permission denied while trying to connect to the Docker daemon socket at unix:///var/run/docker.sock
```

#### è§£å†³æ–¹æ¡ˆï¼š

**æ–¹æ³•ä¸€ï¼šä¸´æ—¶è§£å†³ (æ¨èåˆæ¬¡ä½¿ç”¨)**
åœ¨å‘½ä»¤å‰åŠ ä¸Š `sudo`ï¼š
```bash
sudo docker-compose up -d --build
```

**æ–¹æ³•äºŒï¼šæ°¸ä¹…è§£å†³ (å…sudo)**
å°†å½“å‰ç”¨æˆ·åŠ å…¥ `docker` ç”¨æˆ·ç»„ï¼ˆéœ€è¦é‡æ–°ç™»å½•ç”Ÿæ•ˆï¼‰ï¼š
```bash
# 1. åˆ›å»º docker ç»„ï¼ˆå¦‚æœä¸å­˜åœ¨ï¼‰
sudo groupadd docker

# 2. å°†å½“å‰ç”¨æˆ·åŠ å…¥ docker ç»„
sudo usermod -aG docker $USER

# 3. æ¿€æ´»æ›´æ”¹ï¼ˆæˆ–æ³¨é”€å¹¶é‡æ–°ç™»å½•ï¼‰
newgrp docker

# 4. æµ‹è¯•æƒé™
docker ps
```

### é—®é¢˜0.1ï¼šDocker æ‹‰å–é•œåƒå¤±è´¥ / ç½‘ç»œè¶…æ—¶

#### ç—‡çŠ¶ï¼š
å‡ºç°ç±»ä¼¼ä»¥ä¸‹é”™è¯¯ï¼š
```
failed to solve: node:18-alpine: failed to resolve source metadata for docker.io/library/node:18-alpine: ... not found
```
æˆ–è€…
```
error pulling image configuration: download failed
```

#### è§£å†³æ–¹æ¡ˆï¼š
è¿™æ˜¯ç”±äºç½‘ç»œæ— æ³•è¿æ¥åˆ° Docker Hub å®˜æ–¹ä»“åº“ã€‚éœ€è¦é…ç½®å›½å†…é•œåƒæºã€‚

**æ­¥éª¤ 1: ä¿®æ”¹/åˆ›å»º Docker é…ç½®æ–‡ä»¶**

ç¼–è¾‘ `/etc/docker/daemon.json` æ–‡ä»¶ï¼ˆå¦‚æœæ²¡æœ‰åˆ™æ–°å»ºï¼‰ï¼š

```bash
sudo nano /etc/docker/daemon.json
```

**æ­¥éª¤ 2: æ·»åŠ é•œåƒæºé…ç½®**

å°†ä»¥ä¸‹å†…å®¹å¡«å…¥æ–‡ä»¶ï¼ˆæ³¨æ„ JSON æ ¼å¼ï¼‰ï¼š

```json
{
  "registry-mirrors": [
    "https://docker.m.daocloud.io",
    "https://huecker.io",
    "https://dockerhub.timeweb.cloud",
    "https://noohub.ru"
  ]
}
```

**æ­¥éª¤ 3: é‡å¯ Docker æœåŠ¡**

```bash
sudo systemctl daemon-reload
sudo systemctl restart docker
```

**æ­¥éª¤ 4: å†æ¬¡å°è¯•å¯åŠ¨**

```bash
docker-compose up -d --build
```

### é—®é¢˜1ï¼šæäº¤é—®å·æ—¶æ˜¾ç¤º"ç½‘ç»œå¤±è´¥å¹¶é‡è¯•"

#### å¯èƒ½åŸå› ï¼š
1. åç«¯æœåŠ¡æœªå¯åŠ¨
2. å‰ç«¯ä»£ç†é…ç½®é—®é¢˜
3. ç«¯å£å†²çª
4. APIè·¯å¾„ä¸åŒ¹é…

#### è§£å†³æ­¥éª¤ï¼š

##### æ­¥éª¤1ï¼šæ£€æŸ¥æœåŠ¡çŠ¶æ€
```bash
# æ£€æŸ¥åç«¯æœåŠ¡ï¼ˆåº”è¯¥åœ¨ç«¯å£3000ï¼‰
curl http://localhost:3000

# æ£€æŸ¥å‰ç«¯æœåŠ¡ï¼ˆåº”è¯¥åœ¨ç«¯å£5173ï¼‰
curl http://localhost:5173
```

##### æ­¥éª¤2ï¼šä½¿ç”¨å®Œæ•´ç³»ç»Ÿæµ‹è¯•è„šæœ¬
```bash
# ä½¿ç”¨æ–°çš„å®Œæ•´æµ‹è¯•è„šæœ¬
./test-full-system.sh
```

##### æ­¥éª¤3ï¼šæ‰‹åŠ¨å¯åŠ¨æœåŠ¡
```bash
# ç»ˆç«¯1ï¼šå¯åŠ¨åç«¯
cd backend
npm run start:dev

# ç»ˆç«¯2ï¼šå¯åŠ¨å‰ç«¯
cd frontend
npm run dev
```

##### æ­¥éª¤4ï¼šéªŒè¯APIè¿æ¥
```bash
# æµ‹è¯•é—®å·è·å–API
curl "http://localhost:3000/questionnaires/by-role/é«˜å±‚é¢†å¯¼è€…"

# æµ‹è¯•é—®å·æäº¤APIï¼ˆPOSTè¯·æ±‚ï¼‰
curl -X POST http://localhost:3000/evaluations/submit-questionnaire \
  -H "Content-Type: application/json" \
  -d '{
    "evaluationId": 1,
    "respondentId": 1,
    "relationship": "è‡ªè¯„",
    "responses": [
      {"questionCode": "SD001", "score": 4}
    ]
  }'
```

### é—®é¢˜2ï¼šç«¯å£è¢«å ç”¨

#### è§£å†³æ–¹æ¡ˆï¼š
```bash
# æŸ¥çœ‹ç«¯å£å ç”¨
lsof -i :3000
lsof -i :5173

# æ€æ­»å ç”¨è¿›ç¨‹
kill -9 <PID>

# æˆ–ä½¿ç”¨è„šæœ¬è‡ªåŠ¨æ¸…ç†
./test-full-system.sh  # è„šæœ¬ä¼šè‡ªåŠ¨æ¸…ç†ç«¯å£
```

### é—®é¢˜3ï¼šä¾èµ–å®‰è£…é—®é¢˜

#### è§£å†³æ–¹æ¡ˆï¼š
```bash
# æ¸…ç†å¹¶é‡æ–°å®‰è£…åç«¯ä¾èµ–
cd backend
rm -rf node_modules package-lock.json
npm install

# æ¸…ç†å¹¶é‡æ–°å®‰è£…å‰ç«¯ä¾èµ–
cd ../frontend
rm -rf node_modules package-lock.json
npm install
```

### é—®é¢˜4ï¼šæ•°æ®åº“è¿æ¥é—®é¢˜

#### ç—‡çŠ¶ï¼š
- åç«¯å¯åŠ¨æ—¶æŠ¥æ•°æ®åº“è¿æ¥é”™è¯¯
- APIè¿”å›500é”™è¯¯

#### è§£å†³æ–¹æ¡ˆï¼š
```bash
# æ£€æŸ¥æ•°æ®åº“é…ç½®
cat backend/.env

# ç¡®ä¿æ•°æ®åº“æœåŠ¡è¿è¡Œ
# MySQL:
brew services start mysql

# PostgreSQL:
brew services start postgresql

# æˆ–ä½¿ç”¨Docker:
docker run -d --name test-db -p 3306:3306 -e MYSQL_ROOT_PASSWORD=password mysql:8
```

### é—®é¢˜5ï¼šCORSè·¨åŸŸé—®é¢˜

#### ç—‡çŠ¶ï¼š
- æµè§ˆå™¨æ§åˆ¶å°æ˜¾ç¤ºCORSé”™è¯¯
- ç½‘ç»œè¯·æ±‚è¢«é˜»æ­¢

#### è§£å†³æ–¹æ¡ˆï¼š
æ£€æŸ¥åç«¯CORSé…ç½®ï¼ˆé€šå¸¸åœ¨main.tsä¸­ï¼‰ï¼š
```typescript
app.enableCors({
  origin: 'http://localhost:5173',
  credentials: true,
});
```

## ğŸ” è°ƒè¯•æŠ€å·§

### 1. æµè§ˆå™¨å¼€å‘è€…å·¥å…·
- æ‰“å¼€F12å¼€å‘è€…å·¥å…·
- æŸ¥çœ‹Networkæ ‡ç­¾é¡µ
- æ£€æŸ¥å¤±è´¥çš„è¯·æ±‚è¯¦æƒ…
- æŸ¥çœ‹Consoleé”™è¯¯ä¿¡æ¯

### 2. åç«¯æ—¥å¿—
```bash
# æŸ¥çœ‹åç«¯è¯¦ç»†æ—¥å¿—
cd backend
npm run start:dev

# è§‚å¯Ÿæ§åˆ¶å°è¾“å‡ºçš„é”™è¯¯ä¿¡æ¯
```

### 3. å‰ç«¯ä»£ç†æµ‹è¯•
```bash
# ç›´æ¥æµ‹è¯•ä»£ç†æ˜¯å¦å·¥ä½œ
curl http://localhost:5173/api/questionnaires/selfdirected
```

### 4. APIæµ‹è¯•å·¥å…·
ä½¿ç”¨Postmanæˆ–curlæµ‹è¯•APIï¼š
```bash
# æµ‹è¯•è·å–é—®å·
curl -X GET "http://localhost:3000/questionnaires/by-role/é«˜å±‚é¢†å¯¼è€…"

# æµ‹è¯•æäº¤é—®å·
curl -X POST http://localhost:3000/evaluations/submit-questionnaire \
  -H "Content-Type: application/json" \
  -d @demo-data.json
```

## ğŸ“‹ æ£€æŸ¥æ¸…å•

### å¯åŠ¨å‰æ£€æŸ¥ï¼š
- [ ] Node.jså·²å®‰è£…ï¼ˆv18+ï¼‰
- [ ] npmå¯ç”¨
- [ ] ç«¯å£3000å’Œ5173æœªè¢«å ç”¨
- [ ] æ•°æ®åº“æœåŠ¡è¿è¡Œæ­£å¸¸

### è¿è¡Œæ—¶æ£€æŸ¥ï¼š
- [ ] åç«¯æœåŠ¡åœ¨http://localhost:3000å“åº”
- [ ] å‰ç«¯æœåŠ¡åœ¨http://localhost:5173å“åº”
- [ ] APIä»£ç†é…ç½®æ­£ç¡®
- [ ] æµè§ˆå™¨æ§åˆ¶å°æ— é”™è¯¯

### åŠŸèƒ½æ£€æŸ¥ï¼š
- [ ] å¯ä»¥é€‰æ‹©ä¸åŒè§’è‰²
- [ ] é—®å·å†…å®¹æ­£ç¡®åŠ è½½
- [ ] å¯ä»¥å¡«å†™å’Œæäº¤é—®å·
- [ ] æäº¤åæ˜¾ç¤ºæˆåŠŸä¿¡æ¯

## ğŸ†˜ è·å–æ›´å¤šå¸®åŠ©

### æ—¥å¿—æ–‡ä»¶ä½ç½®ï¼š
- åç«¯æ—¥å¿—ï¼šæ§åˆ¶å°è¾“å‡º
- å‰ç«¯æ—¥å¿—ï¼šæµè§ˆå™¨å¼€å‘è€…å·¥å…·Console
- ç³»ç»Ÿæ—¥å¿—ï¼šæ£€æŸ¥ç³»ç»Ÿæ—¥å¿—æ–‡ä»¶

### å¸¸ç”¨å‘½ä»¤ï¼š
```bash
# æŸ¥çœ‹è¿›ç¨‹
ps aux | grep node

# æŸ¥çœ‹ç«¯å£
netstat -tulpn | grep :3000
netstat -tulpn | grep :5173

# é‡å¯æœåŠ¡
pkill -f "node.*backend"
pkill -f "node.*frontend"
```

### è”ç³»æ”¯æŒï¼š
å¦‚æœé—®é¢˜ä»ç„¶å­˜åœ¨ï¼Œè¯·æä¾›ï¼š
1. é”™è¯¯ä¿¡æ¯æˆªå›¾
2. æµè§ˆå™¨æ§åˆ¶å°æ—¥å¿—
3. åç«¯æ§åˆ¶å°æ—¥å¿—
4. æ“ä½œç³»ç»Ÿä¿¡æ¯

## ğŸ¯ å¿«é€Ÿä¿®å¤

### ä¸€é”®é‡ç½®ï¼š
```bash
# åœæ­¢æ‰€æœ‰æœåŠ¡
pkill -f node

# æ¸…ç†ç«¯å£
lsof -ti:3000 | xargs kill -9 2>/dev/null
lsof -ti:5173 | xargs kill -9 2>/dev/null

# é‡æ–°å¯åŠ¨
./test-full-system.sh
```

### éªŒè¯ä¿®å¤ï¼š
1. è®¿é—® http://localhost:5173
2. é€‰æ‹©è§’è‰²å¹¶å¡«å†™å‡ é“é¢˜
3. ç‚¹å‡»æäº¤æŒ‰é’®
4. ç¡®è®¤æ²¡æœ‰ç½‘ç»œé”™è¯¯

ç¥æ‚¨æµ‹è¯•é¡ºåˆ©ï¼ğŸš€